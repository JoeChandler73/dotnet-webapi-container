{
    "name": "DotNet Web Api",
    "dockerFile": "Dockerfile",
    "features": {
        "ghcr.io/devcontainers/features/docker-in-docker:2": {},
        "./features/kubectl-k9s": {},
        "./features/starship-nerd-font": {
            "nerdFont": "IBMPlexMono",
            "starshipPreset": "no-runtime-versions",
            "fontVersion": "v3.4.0"
        }
    },
    "forwardPorts": [5056, 7136, 8080],
    "portsAttributes": {
        "5056": { 
            "label": "HTTP Dev Server",
            "onAutoForward": "notify"
        },
        "7136": { 
            "label": "HTTPS Dev Server",
            "protocol": "https",
            "onAutoForward": "notify"
        },
        "8080": { 
            "label": "Docker Container",
            "onAutoForward": "silent"
        }
    },
    "customizations": {
        "vscode": {
            "extensions": [
                "ms-dotnettools.csharp",
                "ms-dotnettools.csdevkit",
                "kreativ-software.csharpextensions",
                "PKief.material-icon-theme",
                "dbaeumer.vscode-eslint",
                "ms-dotnettools.vscode-dotnet-runtime",
                "humao.rest-client",
                "ms-kubernetes-tools.vscode-kubernetes-tools"
            ],
            "settings": {
                "terminal.integrated.defaultProfile.linux": "bash",
                "terminal.integrated.profiles.linux": {
                    "bash": {
                        "path": "/bin/bash"
                    }
                }
            }
        }
    },
    "postCreateCommand": "dotnet restore",
    "postStartCommand": "dotnet dev-certs https --trust",
    "mounts": [
        // Mount kubeconfig
        {
            "source": "${localEnv:HOME}${localEnv:USERPROFILE}/.kube",
            "target": "/home/vscode/.kube",
            "type": "bind"
        },
        // Mount Docker config (for private registries, etc.)
        {
            "source": "${localEnv:HOME}${localEnv:USERPROFILE}/.docker",
            "target": "/home/vscode/.docker-host",
            "type": "bind"
        }
    ],
    "containerEnv": {
        "KUBECONFIG": "/home/vscode/.kube/config"
    },
    "remoteUser": "vscode"
}